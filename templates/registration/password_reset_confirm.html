{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}{{ block.super }}
<style>
  /* --- COPIADO DO password_reset_form.html --- */
  body.login {
    background: #ffffff; display: flex; justify-content: center;
    align-items: center; min-height: 100vh; font-family: sans-serif;
  }
  #header { display: none; }
  #container { width: 100%; max-width: 450px; margin: 0 auto; }
  #content { border: none; padding: 0; }
  .auth-box { /* Classe comum para os boxes */
      background-color: #f8f8f8; padding: 2.5rem; border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 1.5rem;
  }
  #branding {
      display: flex; flex-direction: column; align-items: center;
      background: none; box-shadow: none; border: none; margin-bottom: 2rem;
  }
  #branding img { width: 200px; height: auto; margin-bottom: 15px; }
  #branding .auth-title {
      color: #333; font-size: 1.3em; font-weight: normal; margin: 0;
  }
  .form-row { margin-bottom: 1.5rem; }
  .form-row label {
      font-size: 1em; text-align: left; display: block; width: 100%;
      margin-bottom: 5px; color: #555; font-weight: bold;
  }
  .form-row input[type="password"] {
      width: 100%; padding: 12px; border: 1px solid #ccc;
      border-radius: 4px; box-sizing: border-box;
  }
  .helptext { font-size: 0.8em; color: #777; margin-top: 5px; }
  ul.errorlist { list-style: none; padding: 0; color: #ba2121; font-size: 0.9em; margin-top: 5px; }
  .submit-row input[type="submit"], button[type="submit"] {
      width: 100%; padding: 12px; font-size: 1.1em; margin-top: 1rem;
      background-color: #0056b3; border: none; border-radius: 4px;
      color: white; cursor: pointer; font-weight: bold;
  }
  .submit-row input[type="submit"]:hover, button[type="submit"]:hover { background-color: #004494; }
  .errornote { /* Para a mensagem de link inválido */
      color: #ba2121; background-color: #ffdddd; border: 1px solid #ba2121;
      border-radius: 4px; padding: 10px; margin-bottom: 1rem; text-align: center;
  }
  .message p { color: #555; margin-bottom: 1.5rem; line-height: 1.6; text-align: center; }
  .back-link { text-align: center; margin-top: 1rem; font-size: 0.9em; }
  .back-link a { color: #0056b3; text-decoration: none; }
  .back-link a:hover { text-decoration: underline; }
</style>
{% endblock %}

{% block bodyclass %}{{ block.super }} login{% endblock %}

{% block usertools %}{% endblock %}
{% block nav-global %}{% endblock %}
{% block nav-sidebar %}{% endblock %}
{% block content_title %}{% endblock %}
{% block breadcrumbs %}{% endblock %}

{% block content %}
<div id="content-main">

  <div class="auth-box"> {# Div container para o box cinza #}
    <div id="branding">
        <img src="{% static 'logo.png' %}" alt="Logotipo Lider Drive">
        <p class="auth-title">{% translate 'Definir nova senha' %}</p>
    </div>

    {% if validlink %}
      <div class="message">
        <p>{% translate "Por favor, digite sua nova senha duas vezes para verificar que a digitou corretamente." %}</p>
      </div>
      <form method="post">{% csrf_token %}
        <div class="form-row">
            {{ form.new_password1.errors }}
            <label for="{{ form.new_password1.id_for_label }}">{{ form.new_password1.label }}:</label>
            {{ form.new_password1 }}
            {% if form.new_password1.help_text %}
            <div class="helptext">{{ form.new_password1.help_text|safe }}</div>
            {% endif %}
        </div>
        <div class="form-row">
            {{ form.new_password2.errors }}
            <label for="{{ form.new_password2.id_for_label }}">{{ form.new_password2.label }}:</label>
            {{ form.new_password2 }}
            {% if form.new_password2.help_text %}
            <div class="helptext">{{ form.new_password2.help_text|safe }}</div>
            {% endif %}
        </div>
        <div class="submit-row">
          <input type="submit" value="{% translate 'Alterar minha senha' %}">
        </div>
      </form>
    {% else %}
      <p class="errornote">{% translate "O link de redefinição de senha era inválido, possivelmente porque já foi usado. Solicite uma nova redefinição de senha." %}</p>
    {% endif %}

    <div class="back-link">
      {# Link para o login PADRÃO do admin #}
      <a href="{% url 'admin:login' %}">{% translate 'Voltar para o Login' %}</a>
    </div>
  </div> {# Fim do auth-box #}

</div>
{% endblock %}